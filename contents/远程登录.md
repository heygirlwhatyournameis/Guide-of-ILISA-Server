# 1 远程登录

## 1.1 服务器地址

| IP 地址       | 端口 | 协议 |
| ------------- | ---- | ---- |
| 192.168.1.123 | 2000 | SSH  |



## 1.2 SSH 登录

在 Linux / Windows 本地终端使用以下命令：

```shell
ssh [用户名]@192.168.1.123 -p 2000
```

> 注：在第一次登录时，会出现认证提示，询问本地主机是否接受服务器的公钥指纹，此时输入 yes 即可。

服务器返回输入密码提示：

``` 
[用户名]@192.168.1.123's password:
```

输入密码后，出现命令提示符，即表示登录成功：

``` shell
user@ILISA:~$
```



## 1.3 修改密码

使用以下命令修改密码：

```shell
passwd
```



## 1.4 使用公钥登录（免密登录）

在 SSH 协议中，除了使用用户名和密码登录，还可以使用公钥登录。公钥和私钥均保存在本地主机上，开启公钥登录前，需要将公钥提供给服务器保存。登录时，服务器向本地主机发送一段随机字符串，本地主机使用私钥加密后发还至服务器，服务器使用事先存储的公钥解密。如果解密成功，则证明主机是可信的，服务器不再向本地主机要求密码。

### 1.4.1 确认是否有公钥

在 Linux 系统和 Windows 系统中，SSH 公钥和私钥均保存在用户文件夹，其中 Linux 的 SSH 文件夹位于：

```
/home/[用户名]/.ssh
```

而 Windows 的 SSH 文件夹位于：

```
C:\users\[用户名]\.ssh
```

如果在此文件下可以寻找到 **id_rsa** 及 **id_rsa.pub** 两个文件，则可确认本地主机已经拥有公钥和私钥。

### 1.4.2 创建公钥

如果本地主机没有公钥，可以通过以下命令创建：

``` shell
ssh-keygen
```

运行上面的命令以后，会出现一系列提示，可以直接按下回车，即使用默认值。

### 1.4.3 上传公钥

使用下面命令，将公钥提供给服务器存储：

``` shell
ssh-copy-id [用户名]@192.168.1.123 -p 2000
```

需要注意的是，ssh-copy-id 为 Linux 命令。在 Windows 系统下，可以使用第三方的 bash 命令行工具如：Git Bash，如果是 Windows 10 系统，也可以开启系统自带的 Linux 子系统，可参考 [Windows10开启Ubuntu子系统简易步骤](https://zhuanlan.zhihu.com/p/34133795)

### 1.4.4 登录

​	再次使用登录命令，无需密码即可进入服务器：

```shell
ssh [用户名]@192.168.1.123 -p 2000
```



## 1.5 公网登录

ILISA 服务器通过 SSH 反向隧道实现公网访问，位于阿里云的中间服务器会将您的 SSH 访问映射到 ILISA 服务器的 SSH 服务当中。

![SSH 反向隧道原理（来自Xmodulo.com）](D:/08%20Workspace/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%B8%E5%85%B3/contents/pictures/ssh-reverse-tunnel.png)



| IP 地址      | 端口 | 协议 |
| ------------ | ---- | ---- |
| 47.101.59.67 | 2000 | SSH  |

在命令行发起 SSH 登录：

```shell
ssh -p 2000 [用户名]@47.101.59.67
```

注意不能遗漏端口参数，否则会直接发起面向中间服务器的请求，而不是 ILISA 服务器。使用公网服务器依然需要您的用户名和密码，您也可以使用公网服务器的 IP 地址设置公钥登录，方法请参考 1.4 节。